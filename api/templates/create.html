<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MAFIA - Create Room</title>
    <link rel="icon" type="image/png" href="/static/images/logo.ico" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poetsen+One&display=swap"
      rel="stylesheet"
    />

    <style>
      * {
        font-family: "Poetsen One", sans-serif;
        font-weight: 100;
        font-style: normal;
      }

      a {
        text-decoration: none;
        color: #ffffff;
      }

      h1 {
        font-size: 3em;
        color: #ffffff;
        text-align: center;
        margin: 0px 0;
        margin-bottom: 0px;
      }

      h2 {
        font-size: 2em;
        color: #ffffff;
        text-align: center;
        margin: 0px 0;
      }

      h3 {
        font-size: 1.25em;
        color: #d1d1d1;
        text-align: center;
        margin: 0px 0;
      }

      h6 {
        font-size: 1em;
        color: #ffffff;
        text-align: center;
        margin: 5px 0;
      }

      #players {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        width: 100%;
      }

      .player-card {
        display: flex;
        align-items: center;
        width: 100%;
        padding: 7px 15px;
        margin: 5px 0;
        cursor: pointer;
        transition: 0.3s;
        border-radius: 20px;
        border: 3px solid #d1d1d1;
      }

      .player-image {
        width: 50px;
        height: 50px;
        margin-right: 10px;
      }

      .player-info {
        display: flex;
        align-items: center;
        width: 100%;
      }

      .player-details {
        display: flex;
        flex-direction: column;
        align-items: left;
        flex: 1;
      }

      .player-details > h3 {
        text-align: left;
      }

      h5 {
        font-size: 0.75em;
        color: #f3f3f3;
        margin-top: 0px;
        margin-bottom: 5px;
        display: block;
        text-align: left;
      }

      body::-webkit-scrollbar {
        display: none; /* Hide the scrollbar */
      }

      .container::-webkit-scrollbar {
        display: none;
      }

      .container {
        width: 90%;
        max-width: 500px; /* Maximum width for container */
        height: calc(82vh - 70px); /* Subtract the height of the title (70px) */
        margin: 10px;
        background: #000000d0;
        padding: 20px;
        border-radius: 1rem;
        overflow: scroll;

        display: block;
        text-align: center;
        align-content: center;
      }

      button {
        width: 55%;
        background: #4285f4;
        font-family: "Poetsen One", sans-serif;
        font-weight: 400;
        font-style: normal;
        padding: 0.6em 1.3em;
        font-size: 18px;
        border: 3px solid #000000;
        border-radius: 0.4em;
        box-shadow: 0.15em 0.15em #ffffff;
        cursor: pointer;
        color: #ffffff;
      }

      button:hover {
        transform: translate(-0.05em, -0.05em);
        box-shadow: 0.2em 0.2em #ffffff;
      }

      button:active {
        transform: translate(0.05em, 0.05em);
        box-shadow: 0.05em 0.05em #ffffff;
      }

      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100%;
        width: 100%;
        overflow: hidden;
        margin: 0;
        padding: 0;
        --color: rgba(114, 114, 114, 0.3);
        background-color: #1d1d1d;
        background-image: linear-gradient(
            0deg,
            transparent 24%,
            var(--color) 25%,
            var(--color) 26%,
            transparent 27%,
            transparent 74%,
            var(--color) 75%,
            var(--color) 76%,
            transparent 77%,
            transparent
          ),
          linear-gradient(
            90deg,
            transparent 24%,
            var(--color) 25%,
            var(--color) 26%,
            transparent 27%,
            transparent 74%,
            var(--color) 75%,
            var(--color) 76%,
            transparent 77%,
            transparent
          );
        background-size: 55px 55px;
      }

      #ftr-name {
        position: absolute;
        bottom: 2.75vh;
        display: flex;
        align-items: center;
        font-size: 1.25em;
      }
    </style>
    <style>
      .input {
        --input-focus: #ffffff;
        --font-color: #ffffff;
        --font-color-sub: #787878;
        --bg-color: #0d0d0d;
        --main-color: #4285f4;
        width: 50%;
        height: 40px;
        border-radius: 5px;
        border: 2px solid var(--main-color);
        background-color: var(--bg-color);
        box-shadow: 4px 4px var(--main-color);
        color: var(--font-color);
        padding: 5px 10px;
        outline: none;
      }

      .input::placeholder {
        color: var(--font-color-sub);
        opacity: 0.8;
      }

      .input:focus {
        border: 2px solid var(--input-focus);
      }
    </style>
    <style>
      /* The switch - the box around the slider */
      .switch {
        font-size: 17px;
        position: relative;
        display: inline-block;
        width: 3.5em;
        height: 2em;
      }

      /* Hide default HTML checkbox */
      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      /* The slider */
      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #db4437;
        transition: 0.4s;
        border-radius: 10px;
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 1.4em;
        width: 1.4em;
        border-radius: 8px;
        left: 0.3em;
        bottom: 0.3em;
        transform: rotate(270deg);
        background-color: rgb(255, 255, 255);
        transition: 0.4s;
      }

      .switch input:checked + .slider {
        background-color: #4285f4;
      }

      .switch input:checked + .slider:before {
        transform: translateX(1.5em);
      }
    </style>

    <style>
      @media screen and (max-width: 768px) {
        /* Adjust styles for smaller screens */
        .container {
          width: 80%;
          max-width: 100%;
          margin: 5px;
          height: calc(82vh - 70px);
        }
        .input {
          width: 85%;
        }
        button {
          width: 95%;
        }
        #ftr-name {
          font-size: 1em;
          bottom: 1vh;
        }
      }
    </style>
  </head>
  <body>
    <a href="/" style="cursor: pointer"
      ><div style="display: flex; align-items: center">
        <img
          src="/static/images/logo.svg"
          alt="Image"
          style="width: 75px; height: 75px; margin-right: 25px"
        />
        <h1>MAFIA</h1>
      </div>
    </a>
    <div class="container">
      <h2>Create Room</h2>
      <br />
      <input id="name" placeholder="Your Name" name="text" class="input" />
      <br />
      <br />
      <h3 id="details-btn" style="cursor: pointer">Details 🔽</h3>
      <br />

      <div id="details" style="display: none">
        <h6 id="player-cnt">Minimum Player Required = 4</h6>
        <br />
        <div id="players">
          <div class="player-card">
            <div class="player-info">
              <img
                src="/static/images/doctor.png"
                alt="Player Image"
                class="player-image"
              />
              <div class="player-details">
                <h3>DOCTOR</h3>
                <h5>
                  The doctor protects people from being killed at night by
                  choosing to save them.
                </h5>
              </div>
              <label id="doctor" class="switch">
                <input type="checkbox" checked />
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="player-card">
            <div class="player-info">
              <img
                src="/static/images/police.png"
                alt="Player Image"
                class="player-image"
              />
              <div class="player-details">
                <h3>POLICE</h3>
                <h5>
                  The police can investigate one person each night to find out
                  their role.
                </h5>
              </div>
              <label id="police" class="switch">
                <input type="checkbox" checked />
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="player-card">
            <div class="player-info">
              <img
                src="/static/images/prankster.png"
                alt="Player Image"
                class="player-image"
              />
              <div class="player-details">
                <h3>Prankster</h3>
                <h5>
                  The Prankster can stop one person from using their ability
                  each night.
                </h5>
              </div>
              <label id="prankster" class="switch">
                <input type="checkbox" checked />
                <span class="slider"></span>
              </label>
            </div>
          </div>

          <div class="player-card">
            <div class="player-info">
              <img
                src="/static/images/mafia.png"
                alt="Player Image"
                class="player-image"
              />
              <div class="player-details">
                <h3>MAFIA</h3>
                <h5>
                  You have to secretly kill the good guys while pretending to be
                  one of them, so you can win.
                </h5>
              </div>
            </div>
          </div>

          <div class="player-card">
            <div class="player-info">
              <img
                src="/static/images/civillian.png"
                alt="Player Image"
                class="player-image"
              />
              <div class="player-details">
                <h3>CIVILLIAN</h3>
                <h5>
                  You have to find out who the mafia is and vote them out of the
                  game.
                </h5>
              </div>
            </div>
          </div>
        </div>
        <br />
      </div>

      <button onclick="create()">Create Room</button>
      <br />
      <br />
      <h2>or</h2>
      <br />
      <button style="background: #fbbc05; color: #000000" onclick="join()">
        Join Game
      </button>
    </div>
    <div id="ftr-name">
      <span style="color: #ffffff"
        >Made with ❤️ by <a href="https://DeadlineTechTeam">Team DeadlineTech</a></span
      >
    </div>
    <script>
      const urlObj = new URL(window.location.href);
      let url = urlObj.origin;

      var clickAudio = new Audio(`${url}/static/audio/click.mp3`);
      var selectAudio = new Audio(`${url}/static/audio/select.mp3`);

      const detailsBtn = document.getElementById("details-btn");
      const detailsSection = document.getElementById("details");

      detailsBtn.addEventListener("click", function () {
        if (
          detailsSection.style.display === "none" ||
          detailsSection.style.display === ""
        ) {
          detailsSection.style.display = "block";
          detailsBtn.textContent = "Details 🔼";
        } else {
          detailsSection.style.display = "none";
          detailsBtn.textContent = "Details 🔽";
        }
      });

      function join() {
        (async function () {
          await clickAudio.play();
          window.location.href = `${url}/join`;
        })();
      }

      function toast(message, color, duration = 2000) {
        var toast = document.createElement("div");
        toast.textContent = message;
        toast.style.position = "fixed";
        toast.style.top = "10%";
        toast.style.left = "50%";
        toast.style.transform = "translateX(-50%)";
        toast.style.backgroundColor = color;
        toast.style.color = "#fff";
        toast.style.padding = "10px";
        toast.style.borderRadius = "5px";
        toast.style.boxShadow = "0 2px 5px rgba(0, 0, 0, 0.5)";
        toast.style.zIndex = "9999";
        document.body.appendChild(toast);
        setTimeout(function () {
          toast.remove();
        }, duration);
      }

      function create() {
        (async function () {
          await clickAudio.play();
          var playerName = document.getElementById("name").value;
          if (playerName === "") {
            toast("Please enter your name", "#EA4335");
            return;
          }
          var isDoctor = document
            .getElementById("doctor")
            .querySelector("input").checked;
          var isPolice = document
            .getElementById("police")
            .querySelector("input").checked;
          var isPrankster = document
            .getElementById("prankster")
            .querySelector("input").checked;

          hitCreateApi(playerName, isDoctor, isPolice, isPrankster);
        })();
      }

      var inputs = document.querySelectorAll(".input");
      inputs.forEach(function (input) {
        input.addEventListener("focus", function () {
          selectAudio.play();
        });
      });

      var radioInputs = document.querySelectorAll(".radio-input");
      radioInputs.forEach(function (radioInput) {
        radioInput.addEventListener("click", function () {
          selectAudio.play();
        });
      });

      var switchInputs = document.querySelectorAll(".switch input");
      switchInputs.forEach(function (switchInput) {
        switchInput.addEventListener("click", function () {
          selectAudio.play();
        });
      });

      function hitCreateApi(playerName, isDoctor, isPolice, isPrankster) {
        fetch(`${url}/createRoom`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            playerName,
            isDoctor,
            isPolice,
            isPrankster,
          }),
        })
          .then((response) => response.json())
          .then((data) => {
            toast("New Room Created", "#34A853");

            // You are the host, show all player names
            var gamecode = data["code"];
            var hostCode = data["host_code"];

            // store data in local storage
            localStorage.clear();
            localStorage.setItem("gameCode", gamecode);
            localStorage.setItem("hostCode", hostCode);
            localStorage.setItem("playerName", playerName);

            // redirect to game page
            window.location.href = `${url}/play`;
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      }
    </script>
  </body>
</html>
